
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../install%20mysql-v5.7%20on%20centos_v7.9/">
      
      
        <link rel="next" href="../join%20SOHU/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>java PorterStemmer in Lucene - 一哥黑板报</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="一哥黑板报" class="md-header__button md-logo" aria-label="一哥黑板报" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            一哥黑板报
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              java PorterStemmer in Lucene
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="一哥黑板报" class="md-nav__button md-logo" aria-label="一哥黑板报" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    一哥黑板报
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome to MkDocs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Posts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Posts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12%20Years%2C%201780%20Kilometers%2C%206%20Hours/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12 Years, 1780 Kilometers, 6 Hours
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CSRF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSRF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Idealism%20and%20Realism/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Idealism and Realism
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Python%20Socket%20Programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python Socket Programming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../QCon%20Beijing%202013/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    QCon Beijing 2013
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Switch%20Homebrew%20to%20a%20china%20mirror/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Switch Homebrew to a china mirror
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../What%20i%20fear%20most%20is%20losing%20my%20curiosity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What i fear most is losing my curiosity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../a%20quick%20guide%20to%20using%20tornado/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A quick guide to using tornado
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../a%20user%20guild%20to%20using%20webpy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A user guild to using webpy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ab%20testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ab testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agile%20practice%20summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agile practice summary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fudge%20using%20document/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fudge using document
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gevent%20on%20pypy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gevent on pypy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../growth%20hacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Growth hacking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hibernate%20simple%20tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hibernate simple tutorials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install%20mysql-v5.7%20on%20centos_v7.9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install mysql v5.7 on centos v7.9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    java PorterStemmer in Lucene
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../join%20SOHU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    join SOHU
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../loaddata%20of%20mysql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loaddata of mysql
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parse%20html%20with%20python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parse html with python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performace%20optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performace optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python%20tricks%20and%20hacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python tricks and hacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python%20validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../some%20common%20metrics%20in%20Data%20Analysis%20and%20Statistics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    some common metrics in Data Analysis and Statistics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../this%20is%20not%20the%20time%20to%20work%20yourself%20to%20death/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    This is not the time to work yourself to death
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thoughts%20on%20building%20a%20production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thoughts on building a production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thoughts%20on%20vertical%20website%20crawler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thoughts on vertical website crawler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../translation%3A%20rethinking%20kanban/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Translation: rethinking kanban
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%97%A0%E5%85%B1%E4%BA%AB%E6%9E%B6%E6%9E%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    无共享架构
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>java PorterStemmer in Lucene</h1>

<p>+++
title = "java常用工具-PorterStemmer"
date = 2009-03-28</p>
<p>categories = ["Tech"]
tags = ["Java", "PorterStemmer"]
+++</p>
<p>搜索引擎在进行索引和检索的时候，需要对一些词语的各种形式转换为原型。在 Lucene 中，提供了这样的一个java文件。</p>
<pre><code class="language-java">import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;

import StringUtil;

/**
 * Copyright 2004 The Apache Software Foundation
 * &lt;p&gt;
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * &lt;p&gt;
 * http://www.apache.org/licenses/LICENSE-2.0
 * &lt;p&gt;
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*

    Porter stemmer in Java. The original paper is in

    Porter, 1980, An algorithm for suffix stripping, Program, Vol. 14,
    no. 3, pp 130-137,

    See also http://www.tartarus.org/~martin/PorterStemmer/index.html

    Bug 1 (reported by Gonzalo Parra 16/10/99) fixed as marked below.
    Tthe words 'aed', 'eed', 'oed' leave k at 'a' for step 3, and b[k-1]
    is then out outside the bounds of b.

    Similarly,

    Bug 2 (reported by Steve Dyrdahl 22/2/00) fixed as marked below.
    'ion' by itself leaves j = -1 in the test for 'ion' in step 5, and
    b[j] is then outside the bounds of b.

    Release 3.

    [ This version is derived from Release 3, modified by Brian Goetz to
    optimize for fewer object creations.  ]

    */

/**
 * Stemmer, implementing the Porter Stemming Algorithm The Stemmer class transforms a word into its root form. The input word can be provided a character at
 * time (by calling add()), or at once by calling one of the various stem(something) methods.
 */

public class PorterStemmer {
    private char[] b;

    private int i, /* offset into b */
            j, k, k0;

    private boolean dirty = false;

    private static final int INC = 50; /* unit of size whereby b is increased */

    private static final int EXTRA = 1;

    public PorterStemmer() {
        b = new char[INC];
        i = 0;
    }

    /**
     * reset() resets the stemmer so it can stem another word. If you invoke the stemmer by calling add(char) and then stem(), you must call reset() before
     * starting another word.
     */
    public void reset() {
        i = 0;
        dirty = false;
    }

    /**
     * Add a character to the word being stemmed. When you are finished adding characters, you can call stem(void) to process the word.
     */
    public void add(char ch) {
        if (b.length &lt;= i + EXTRA) {
            char[] new_b = new char[b.length + INC];
            for (int c = 0; c &lt; b.length; c++)
                new_b[c] = b[c];
            b = new_b;
        }
        b[i++] = ch;
    }

    /**
     * After a word has been stemmed, it can be retrieved by toString(), or a reference to the internal buffer can be retrieved by getResultBuffer and
     * getResultLength (which is generally more efficient.)
     */
    public String toString() {
        return new String(b, 0, i);
    }

    /**
     * Returns the length of the word resulting from the stemming process.
     */
    public int getResultLength() {
        return i;
    }

    /**
     * Returns a reference to a character buffer containing the results of the stemming process. You also need to consult getResultLength() to determine the
     * length of the result.
     */
    public char[] getResultBuffer() {
        return b;
    }

    /* cons(i) is true &lt;=&gt; b[i] is a consonant. */

    private final boolean cons(int i) {
        switch (b[i]) {
            case 'a':
            case 'e':
            case 'i':
            case 'o':
            case 'u':
                return false;
            case 'y':
                return (i == k0) ? true : !cons(i - 1);
            default:
                return true;
        }
    }

    /*
     * m() measures the number of consonant sequences between k0 and j. if c is a consonant sequence and v a vowel sequence, and &lt;..&gt; indicates arbitrary
     * presence, &lt;c&gt;&lt;v&gt; gives 0 &lt;c&gt;vc&lt;v&gt; gives 1 &lt;c&gt;vcvc&lt;v&gt; gives 2 &lt;c&gt;vcvcvc&lt;v&gt; gives 3 ....
     */
    private final int m() {
        int n = 0;
        int i = k0;
        while (true) {
            if (i &gt; j)
                return n;
            if (!cons(i))
                break;
            i++;
        }
        i++;
        while (true) {
            while (true) {
                if (i &gt; j)
                    return n;
                if (cons(i))
                    break;
                i++;
            }
            i++;
            n++;
            while (true) {
                if (i &gt; j)
                    return n;
                if (!cons(i))
                    break;
                i++;
            }
            i++;
        }
    }

    /* vowelinstem() is true &lt;=&gt; k0,...j contains a vowel */
    private final boolean vowelinstem() {
        int i;
        for (i = k0; i &lt;= j; i++)
            if (!cons(i))
                return true;
        return false;
    }

    /* doublec(j) is true &lt;=&gt; j,(j-1) contain a double consonant. */
    private final boolean doublec(int j) {
        if (j &lt; k0 + 1)
            return false;
        if (b[j] != b[j - 1])
            return false;
        return cons(j);
    }

    /*
     * cvc(i) is true &lt;=&gt; i-2,i-1,i has the form consonant - vowel - consonant and also if the second c is not w,x or y. this is used when trying to restore an
     * e at the end of a short word. e.g. cav(e), lov(e), hop(e), crim(e), but snow, box, tray.
     */
    private final boolean cvc(int i) {
        if (i &lt; k0 + 2 || !cons(i) || cons(i - 1) || !cons(i - 2))
            return false;
        else {
            int ch = b[i];
            if (ch == 'w' || ch == 'x' || ch == 'y')
                return false;
        }
        return true;
    }

    private final boolean ends(String s) {
        int l = s.length();
        int o = k - l + 1;
        if (o &lt; k0)
            return false;
        for (int i = 0; i &lt; l; i++)
            if (b[o + i] != s.charAt(i))
                return false;
        j = k - l;
        return true;
    }

    /*
     * setto(s) sets (j+1),...k to the characters in the string s, readjusting k.
     */
    void setto(String s) {
        int l = s.length();
        int o = j + 1;
        for (int i = 0; i &lt; l; i++)
            b[o + i] = s.charAt(i);
        k = j + l;
        dirty = true;
    }

    /* r(s) is used further down. */
    void r(String s) {
        if (m() &gt; 0)
            setto(s);
    }

    /*
     * step1() gets rid of plurals and -ed or -ing. e.g. caresses -&gt; caress ponies -&gt; poni ties -&gt; ti caress -&gt; caress cats -&gt; cat feed -&gt; feed agreed -&gt; agree
     * disabled -&gt; disable matting -&gt; mat mating -&gt; mate meeting -&gt; meet milling -&gt; mill messing -&gt; mess meetings -&gt; meet
     */
    private final void step1() {
        if (b[k] == 's') {
            if (ends(&quot;sses&quot;))
                k -= 2;
            else if (ends(&quot;ies&quot;))
                setto(&quot;i&quot;);
            else if (b[k - 1] != 's')
                k--;
        }
        if (ends(&quot;eed&quot;)) {
            if (m() &gt; 0)
                k--;
        } else if ((ends(&quot;ed&quot;) || ends(&quot;ing&quot;)) &amp;&amp; vowelinstem()) {
            k = j;
            if (ends(&quot;at&quot;))
                setto(&quot;ate&quot;);
            else if (ends(&quot;bl&quot;))
                setto(&quot;ble&quot;);
            else if (ends(&quot;iz&quot;))
                setto(&quot;ize&quot;);
            else if (doublec(k)) {
                int ch = b[k--];
                if (ch == 'l' || ch == 's' || ch == 'z')
                    k++;
            } else if (m() == 1 &amp;&amp; cvc(k))
                setto(&quot;e&quot;);
        }
    }

    /* step2() turns terminal y to i when there is another vowel in the stem. */
    private final void step2() {
        if (ends(&quot;y&quot;) &amp;&amp; vowelinstem()) {
            b[k] = 'i';
            dirty = true;
        }
    }

    /*
     * step3() maps double suffices to single ones. so -ization ( = -ize plus -ation) maps to -ize etc. note that the string before the suffix must give m() &gt; *
     * 0.
     */
    private final void step3() {
        if (k == k0)
            return; /* For Bug 1 */
        switch (b[k - 1]) {
            case 'a':
                if (ends(&quot;ational&quot;)) {
                    r(&quot;ate&quot;);
                    break;
                }
                if (ends(&quot;tional&quot;)) {
                    r(&quot;tion&quot;);
                    break;
                }
                break;
            case 'c':
                if (ends(&quot;enci&quot;)) {
                    r(&quot;ence&quot;);
                    break;
                }
                if (ends(&quot;anci&quot;)) {
                    r(&quot;ance&quot;);
                    break;
                }
                break;
            case 'e':
                if (ends(&quot;izer&quot;)) {
                    r(&quot;ize&quot;);
                    break;
                }
                break;
            case 'l':
                if (ends(&quot;bli&quot;)) {
                    r(&quot;ble&quot;);
                    break;
                }
                if (ends(&quot;alli&quot;)) {
                    r(&quot;al&quot;);
                    break;
                }
                if (ends(&quot;entli&quot;)) {
                    r(&quot;ent&quot;);
                    break;
                }
                if (ends(&quot;eli&quot;)) {
                    r(&quot;e&quot;);
                    break;
                }
                if (ends(&quot;ousli&quot;)) {
                    r(&quot;ous&quot;);
                    break;
                }
                break;
            case 'o':
                if (ends(&quot;ization&quot;)) {
                    r(&quot;ize&quot;);
                    break;
                }
                if (ends(&quot;ation&quot;)) {
                    r(&quot;ate&quot;);
                    break;
                }
                if (ends(&quot;ator&quot;)) {
                    r(&quot;ate&quot;);
                    break;
                }
                break;
            case 's':
                if (ends(&quot;alism&quot;)) {
                    r(&quot;al&quot;);
                    break;
                }
                if (ends(&quot;iveness&quot;)) {
                    r(&quot;ive&quot;);
                    break;
                }
                if (ends(&quot;fulness&quot;)) {
                    r(&quot;ful&quot;);
                    break;
                }
                if (ends(&quot;ousness&quot;)) {
                    r(&quot;ous&quot;);
                    break;
                }
                break;
            case 't':
                if (ends(&quot;aliti&quot;)) {
                    r(&quot;al&quot;);
                    break;
                }
                if (ends(&quot;iviti&quot;)) {
                    r(&quot;ive&quot;);
                    break;
                }
                if (ends(&quot;biliti&quot;)) {
                    r(&quot;ble&quot;);
                    break;
                }
                break;
            case 'g':
                if (ends(&quot;logi&quot;)) {
                    r(&quot;log&quot;);
                    break;
                }
        }
    }

    /* step4() deals with -ic-, -full, -ness etc. similar strategy to step3. */
    private final void step4() {
        switch (b[k]) {
            case 'e':
                if (ends(&quot;icate&quot;)) {
                    r(&quot;ic&quot;);
                    break;
                }
                if (ends(&quot;ative&quot;)) {
                    r(&quot;&quot;);
                    break;
                }
                if (ends(&quot;alize&quot;)) {
                    r(&quot;al&quot;);
                    break;
                }
                break;
            case 'i':
                if (ends(&quot;iciti&quot;)) {
                    r(&quot;ic&quot;);
                    break;
                }
                break;
            case 'l':
                if (ends(&quot;ical&quot;)) {
                    r(&quot;ic&quot;);
                    break;
                }
                if (ends(&quot;ful&quot;)) {
                    r(&quot;&quot;);
                    break;
                }
                break;
            case 's':
                if (ends(&quot;ness&quot;)) {
                    r(&quot;&quot;);
                    break;
                }
                break;
        }
    }

    /* step5() takes off -ant, -ence etc., in context &lt;c&gt;vcvc&lt;v&gt;. */
    private final void step5() {
        if (k == k0)
            return; /* for Bug 1 */
        switch (b[k - 1]) {
            case 'a':
                if (ends(&quot;al&quot;))
                    break;
                return;
            case 'c':
                if (ends(&quot;ance&quot;))
                    break;
                if (ends(&quot;ence&quot;))
                    break;
                return;
            case 'e':
                if (ends(&quot;er&quot;))
                    break;
                return;
            case 'i':
                if (ends(&quot;ic&quot;))
                    break;
                return;
            case 'l':
                if (ends(&quot;able&quot;))
                    break;
                if (ends(&quot;ible&quot;))
                    break;
                return;
            case 'n':
                if (ends(&quot;ant&quot;))
                    break;
                if (ends(&quot;ement&quot;))
                    break;
                if (ends(&quot;ment&quot;))
                    break;
                /* element etc. not stripped before the m */
                if (ends(&quot;ent&quot;))
                    break;
                return;
            case 'o':
                if (ends(&quot;ion&quot;) &amp;&amp; j &gt;= 0 &amp;&amp; (b[j] == 's' || b[j] == 't'))
                    break;
                /* j &gt;= 0 fixes Bug 2 */
                if (ends(&quot;ou&quot;))
                    break;
                return;
            /* takes care of -ous */
            case 's':
                if (ends(&quot;ism&quot;))
                    break;
                return;
            case 't':
                if (ends(&quot;ate&quot;))
                    break;
                if (ends(&quot;iti&quot;))
                    break;
                return;
            case 'u':
                if (ends(&quot;ous&quot;))
                    break;
                return;
            case 'v':
                if (ends(&quot;ive&quot;))
                    break;
                return;
            case 'z':
                if (ends(&quot;ize&quot;))
                    break;
                return;
            default:
                return;
        }
        if (m() &gt; 1)
            k = j;
    }

    /* step6() removes a final -e if m() &gt; 1. */

    private final void step6() {
        j = k;
        if (b[k] == 'e') {
            int a = m();
            if (a &gt; 1 || a == 1 &amp;&amp; !cvc(k - 1))
                k--;
        }
        if (b[k] == 'l' &amp;&amp; doublec(k) &amp;&amp; m() &gt; 1)
            k--;
    }

    /**
     * Stem a word provided as a String. Returns the result as a String.
     */
    public String stem(String s) {
        if (stem(s.toCharArray(), s.length()))
            return toString();
        else
            return s;
    }

    /**
     * Stem a word contained in a char[]. Returns true if the stemming process resulted in a word different from the input. You can retrieve the result with
     * getResultLength()/getResultBuffer() or toString().
     */
    public boolean stem(char[] word) {
        return stem(word, word.length);
    }

    /**
     * Stem a word contained in a portion of a char[] array. Returns true if the stemming process resulted in a word different from the input. You can retrieve
     * the result with getResultLength()/getResultBuffer() or toString().
     */
    public boolean stem(char[] wordBuffer, int offset, int wordLen) {
        reset();
        if (b.length &lt; wordLen) {
            char[] new_b = new char[wordLen + EXTRA];
            b = new_b;
        }
        for (int j = 0; j &lt; wordLen; j++)
            b[j] = wordBuffer[offset + j];
        i = wordLen;
        return stem(0);
    }

    /**
     * Stem a word contained in a leading portion of a char[] array. Returns true if the stemming process resulted in a word different from the input. You can
     * retrieve the result with getResultLength()/getResultBuffer() or toString().
     */
    public boolean stem(char[] word, int wordLen) {
        return stem(word, 0, wordLen);
    }

    /**
     * Stem the word placed into the Stemmer buffer through calls to add(). Returns true if the stemming process resulted in a word different from the input.
     * You can retrieve the result with getResultLength()/getResultBuffer() or toString().
     */
    public boolean stem() {
        return stem(0);
    }

    public boolean stem(int i0) {
        k = i - 1;
        k0 = i0;
        if (k &gt; k0 + 1) {
            step1();
            step2();
            step3();
            step4();
            step5();
            step6();
        }
        // Also, a word is considered dirty if we lopped off letters
        // Thanks to Ifigenia Vairelles for pointing this out.
        if (i != k + 1)
            dirty = true;
        i = k + 1;
        return dirty;
    }

    /**
     * Test program for demonstrating the Stemmer. It reads a file and stems each word, writing the result to standard out. Usage: Stemmer file-name
     *
     * @throws IOException
     */
    public static void main(String[] args) throws IOException {
        PorterStemmer s = new PorterStemmer();
        String[] str = new String[]{&quot;d://stop.txt&quot;};
        for (String key : str) {
            InputStream in = new FileInputStream(key);
            byte[] buffer = new byte[1024];
            int bufferLen, offset, ch;

            bufferLen = in.read(buffer);
            offset = 0;
            s.reset();

            while (true) {
                if (offset &lt; bufferLen)
                    ch = buffer[offset++];
                else {
                    bufferLen = in.read(buffer);
                    offset = 0;
                    if (bufferLen &lt; 0)
                        ch = -1;
                    else
                        ch = buffer[offset++];
                }

                if (StringUtil.isLetter((char) ch)) {
                    s.add(Character.toLowerCase((char) ch));
                } else {
                    s.stem();
                    System.out.print(s.toString());
                    s.reset();
                    if (ch &lt; 0)
                        break;
                    else
                        System.out.print((char) ch);
                }
            }
            in.close();
        }
    }
}
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>